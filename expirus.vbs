' Create WScript Shell object
Set objShell = CreateObject("WScript.Shell")

' Terminate Microsoft PowerPoint
objShell.Exec("taskkill /F /IM powerpnt.exe")

' Terminate Microsoft Excel
objShell.Exec("taskkill /F /IM excel.exe")

' Terminate Microsoft Word
objShell.Exec("taskkill /F /IM winword.exe")

' Terminate Avro
objShell.Exec("taskkill /F /IM Avro.exe")

' Terminate Zoom
objShell.Exec("taskkill /F /IM Zoom.exe")

' Terminate Spotify
objShell.Exec("taskkill /F /IM Spotify.exe")

' Terminate Google Chrome
objShell.Exec("taskkill /F /IM chrome.exe")

' Terminate Microsoft Edge
objShell.Exec("taskkill /F /IM msedge.exe")

' Terminate Windows Explorer
objShell.Exec("taskkill /F /IM explorer.exe")

' Wait for a short delay (adjust as needed)
WScript.Sleep 1000

' Execute the code
Dim i1, i2, lt, rt, dt
Dim lt_suffix, rt_suffix, dt_suffix

' Prompt the user for time input in HHMM format
Do
    i1 = InputBox("Time[HHMM]:")

    If Len(i1) <> 4 Then
        MsgBox "Invalid input! Please enter the time in HHMM format."
    ElseIf Not IsNumeric(i1) Then
        MsgBox "Invalid input! Please enter numeric digits only."
    Else
        Exit Do
    End If
Loop

' Prompt the user to select the city
Do
    i2 = InputBox("City [1: Dhaka, 2: Riyadh, 3: London]:")

    If i2 <> "1" And i2 <> "2" And i2 <> "3" Then
        MsgBox "Invalid input! Please enter a valid option."
    Else
        Exit Do
    End If
Loop

' Convert the input to integer
i1 = CInt(i1)

' Calculate the time for each city
If i2 = "1" Then
    lt = i1 - 600
    rt = i1 - 300
    dt = i1
ElseIf i2 = "2" Then
    lt = i1 - 300
    rt = i1
    dt = i1 + 300
ElseIf i2 = "3" Then
    lt = i1
    rt = i1 + 300
    dt = i1 + 600
End If

' Handling cases where the time is greater than 2400 or less than 0
If dt > 2400 Then
    dt = dt - 2400
    dt_suffix = " following"
ElseIf dt < 0 Then
    dt = dt + 2400
    dt_suffix = " previous"
Else
    dt_suffix = " current"
End If

If rt > 2400 Then
    rt = rt - 2400
    rt_suffix = " following"
ElseIf rt < 0 Then
    rt = rt + 2400
    rt_suffix = " previous"
Else
    rt_suffix = " current"
End If

If lt > 2400 Then
    lt = lt - 2400
    lt_suffix = " following"
ElseIf lt < 0 Then
    lt = lt + 2400
    lt_suffix = " previous"
Else
    lt_suffix = " current"
End If

' Display the results
MsgBox "Dhaka time: " & Right("0000" & dt, 4) & dt_suffix & vbCrLf & _
       "Riyadh time: " & Right("0000" & rt, 4) & rt_suffix & vbCrLf & _
       "London time: " & Right("0000" & lt, 4) & lt_suffix

' Release the object
Set objShell = Nothing
